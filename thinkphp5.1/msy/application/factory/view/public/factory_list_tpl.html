<section class="message-center-info f20" style="display:none;" id="factoryList">
    <ul class="vendorInfoList">
        {volist name='factoryList' id='vo'}
        <li data-id="{$vo.id}">
            <span>{$vo.name}</span>
        </li>
        {/volist}
    </ul>
</section>
<script type="text/javascript">
    $(function () {
        var factoryList = '{:json_encode($factoryList)}';
        //如果是多供应商
        if(factoryList!='null'){
            //选择供应商
            var factoryList = $('#factoryList').html();
            layer.open({
                title:['选择供应商','border-bottom:1px solid #d9d9d9;'],
                className:'factoryListLayer',
                type: 1,
                content: factoryList,
                anim: 'up',
                style: '',
                success:function(){
                    var winHeight=$(window).height();
                    $('.signIn-wrapper').css('height',winHeight-120+'px');
                },
                btn:['确定'],
                yes:function(index){
                    var postData = {};
                    postData.factoryId = $('.factoryListLayer li.current').data('id');
                    if(!postData.factoryId){
                        dialog.error('请选择供应商');
                        return false;
                    }
                    var url = 'setDefaultFactory';
                    $.post(url,postData,function(data){
                        if(data.status==0){
                            dialog.error(data.info);
                        }else if(data.status==1){
                            layer.close(index);
                        }
                    });
                }
            });
        }
        //选择效果
        $('body').on('click','.factoryListLayer li',function(){
            $('.factoryListLayer li').removeClass('current');
            $(this).toggleClass('current');
        });
    });
    function factoryList() {
        layer.open({
            title:['选择供应商','border-bottom:1px solid #d9d9d9;'],
            className:'factoryListLayer',
            type: 1,
            content: factoryList,
            anim: 'up',
            style: '',
            success:function(){
                var winHeight=$(window).height();
                $('.signIn-wrapper').css('height',winHeight-120+'px');
            },
            btn:['确定'],
            yes:function(index){
                var postData = {};
                postData.factoryId = $('.factoryListLayer li.current').data('id');
                if(!postData.factoryId){
                    dialog.error('请选择供应商');
                    return false;
                }
                var url = 'setDefaultFactory';
                $.post(url,postData,function(data){
                    if(data.status==0){
                        dialog.error(data.info);
                    }else if(data.status==1){
                        layer.close(index);
                    }
                });
            }
        });
    }
</script>