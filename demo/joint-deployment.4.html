<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>联营部署(采购供应联营-增加商品)</title>
    <link rel="stylesheet" href="public/static/common/css/base.css">
    <link rel="stylesheet" href="public/static/common/css/public.css">
	<link rel="stylesheet" href="public/static/factory/css/main.css">
    <link rel="stylesheet" href="public/static/common/js/layer.mobile/need/layer.css">
</head>
<body>
<!--缩略图-->
<section id="uploadThumbnail" style="display: none;">
    <p class="f20 upload_st_logo"><span class="friend-tipc">*注意</span>：必须上传图片(格式为jpg、jpeg、png、gif)</p>                    
    <form>
        <div class="upload-picture-module f24">
            <div>
                <div class="picture-module">
                    <input type="file" class="uploadImg uploadSingleImg" name="">
                    <img class="upload_img" src="" alt="">
                    <input type="hidden" class="layer-thumbnail-picture" value=""/>
                </div>
                <!--<p>企业营业执照</p>-->
            </div>
        </div>
    </form>    
</section>
<!--视频-->
<section id="goodsVideoList" style="display: none;">
    <p class="f20 upload_st_logo"><span class="friend-tipc">*注意</span>：必须上传图片(格式为jpg、jpeg、png、gif)</p>     
    <form class="">
        <ul class="upload-picture-module multi-picture-module f24"></ul>
    </form>               
    <form>
        <div class="upload-picture-module f24">
            <div>
                <div class="picture-module">
                    <input type="file" class="uploadImg uploadSingleVideo" name="" accept="video/*" multiple="" >
                    <img class="upload_img" src="" alt="">
                    <input type="hidden" class="layer-thumbnail-picture" value=""/>
                </div>
                <!--<p>企业营业执照</p>-->
            </div>
        </div>
    </form>    
</section>
<!--设置商品的检索品类-->
<section id="categoryContent" style="display:none;">
    <div class="category-wrapper">
        <div class="category-left-menu">
            <ul class="category-tab">
                <li class="current">
                    <a href="javascript:void(0);">大类1</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类2</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类3</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类4</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类5</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类6</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类7</a>
                </li>
                <li>
                    <a href="javascript:void(0);">大类8</a>
                </li>
            </ul>
        </div>
        <div class="category-content-wrapper">
            <!--<p>设置商品的检索品类标签<br/>方法：点击左边大类，右边</p>-->
            <div class="category-content">
                <ul class="category-type columns_flex">
                    <li>
                        <a>分类1111</a>
                    </li>
                    <li>
                        <a>分类1111</a>
                    </li>
                    <li>
                        <a>分类1111</a>
                    </li>
                    <li>
                        <a>分类2222</a>
                    </li>
                    <li>
                        <a>分类22222</a>
                    </li>
                    <li>
                        <a>分类22222</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>
<!--编辑分类标签-->
<section id="editGoodsLabel" style="display:none;">
    <ul class="vendorInfoList">
        <li data-id="1">标签1</li>   
        <li data-id="2">标签2</li>   
        <li data-id="3">标签3</li>   
    </ul>
</section>
<!--编辑商品参数-->
<section id="editGoodsParameter" style="display: none;">
    <div>
        <textarea class="editGoodsText" name="" id="" cols="30" rows="10" val=""></textarea>
    </div>
</section>
<!--编辑商品详情-->
<section id="editDetail" style="display: none;">
    <p class="f20 upload_st_logo"><span class="friend-tipc">*注意</span>：必须上传图片(格式为jpg、jpeg、png、gif)</p>                    
    <form class="">
        <ul class="upload-picture-module multi-picture-module f24"></ul>
    </form>
    <div class="upload-picture-module f24">
        <div>
            <div class="picture-module">
                <input type="file" class="uploadMultiImg" id="file" name="" accept="image/*" multiple="" >
                <img class="upload_img" src="" alt="">
                <input type="hidden" class="business-license" value=""/>
            </div>
        </div>
    </div>
</section>
<article class="f24">
    <section>
        <form class="addProductContent">
            <ul>
                <li>
                    <span class="form-title">商品名称</span>
                    <input type="text" name="goodsName" value="" placeholder="商品名称,字数限18字" class="goods-name input-text">
                </li>
                <li>
                    <span class="form-title">商品特点</span>
                    <textarea rows="" cols="" name="goodsCharacter" placeholder="商品简要说明,字数限28字" class="goods-character input-text"></textarea>
                </li>
                <li>
                    <span class="form-title">商品价格</span>
                    <span class="price-flex">
                        <label for="">结算价￥</label>
                        <input type="text" name="settlePrice" value="" placeholder="68.00" class="settle-price">
                    </span>
                    <span class="price-flex">
                        <label for="">零售价￥</label>
                        <input type="text" name="retailPrice" value="" placeholder="688.00" class="retail-price">
                    </span>
                </li>
                <li >
                    <a href="javascript:void(0);" class="upload-thumbnail right-arrow" >上传商品缩略图</a>
                    <input type="hidden" class="thumbnail-picture" value="" name="thumbnailPicture">
                </li>
                <li class="">
                    <a href="javascript:void(0);" class="editGoodsLabel right-arrow" >编辑商品分类标签</a>
                    <input type="hidden" class="goods-tag" data-id="" value="" name="goodsTag">
                </li>
                <li class="">
                    <a href="javascript:void(0);" class="uploadFocusPicture right-arrow">上传商品首焦图</a>
                    <input type="hidden" class="focus-picture" value="" name="focusPicture">
                </li>
                <li class="">
                    <a href="javascript:void(0);" class="uploadGoodsVideo right-arrow">上传商品视频(可选项)</a>
                    <input type="hidden" class="focus-picture" value="" name="focusPicture">
                </li>
                <li class="">
                    <a href="javascript:void(0);" class="editGoodsParameter right-arrow">编辑商品参数</a>
                    <input type="hidden" class="goods-parameter" value="" name="goodsParameter">
                </li>
                <li class="">
                    <a href="javascript:void(0);" class="editDetail right-arrow">编辑商品详情</a>
                    <input type="hidden" class="goods-detail" data-src="" value="" name="goodsDetail">
                </li>
                <li class="">
                    <a href="javascript:void(0);" class="set-category right-arrow">设置检索品类</a>
                    <input type="hidden" class="select-category" data-src="" value="" name="selectCategory">
                </li>
            </ul>
        </form>
    </section>
</article>
<a href="javascript:void(0);" class="identifyNewGoods foot-btn f24">确定</a>
<script type="text/javascript" src="public/static/common/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="public/static/common/js/public.js"></script>
<script type="text/javascript" src="public/static/common/js/swipe.js"></script>
<script type="text/javascript" src="public/static/common/js/common.js"></script>
<script type="text/javascript" src="public/static/common/js/dialog.js"></script>
<script type="text/javascript" src="public/static/factory/js/uploadMultiImg1111.js"></script>
<script type="text/javascript" src="public/static/common/js/layer.mobile/layer.js"></script>
<script>
    $(function(){
         //上传缩略图
        var uploadThumbnail=$('#uploadThumbnail').html();
        $('body').on('click','.upload-thumbnail',function(){
            layer.open({
                title:['上传缩略图','border-bottom:1px solid #d9d9d9;'],
                className:'uploadThumbnailLayer',
                content:uploadThumbnail,
                btn:['确定','取消'],
                success:function(){
                    var thumbnailSrc=$('.thumbnail-picture').val();
                    $('.uploadThumbnailLayer img').attr('src',thumbnailSrc);
                    
                },
                yes:function(index){
                    var layerThumbnailSrc=$('.uploadThumbnailLayer img').attr('src');
                    $('.thumbnail-picture').val(layerThumbnailSrc);
                    layer.close(index);
                }
            })
        });

        //选择商品分类标签
        var editGoodsLabel=$('#editGoodsLabel').html();
        $('body').on('click','.editGoodsLabel',function(){
            var factoryLayerName,factoryLayerId;
            layer.open({
                title:['商品分类标签','border-bottom:1px solid #d9d9d9'],
                className:'editGoodsLayer',
                content:editGoodsLabel,
                btn:['确定','取消'],
                success:function(){
                    var factoryId=$('.goods-tag').data('id');
                    $('.editGoodsLayer li').on('click',function(){
                        var _this=$(this);
                        _this.addClass('current').siblings().removeClass('current');
                    });
                    $.each($('.editGoodsLayer li'),function(){
                        var currentId=$(this).data('id');
                        if(factoryId==currentId){
                            $(this).addClass('current');
                        }
                    })
                },
                yes:function(index){
                    var isCurrent=$('.editGoodsLayer li.current');
                    goodsTagLayerName=isCurrent.text();
                    goodsTagLayerId  =isCurrent.data('id');
                    $('.goods-tag').val(goodsTagLayerName);
                    $('.goods-tag').data('id',goodsTagLayerId);
                    layer.close(index);
                }
            })
        });
        //上传首焦图
        $('body').on('click','.uploadFocusPicture',function(){
            layer.open({
                title:['上传商品首焦图'],
                className:'uploadFocusLayer',
                content:uploadThumbnail,
                btn:['确定','取消'],
                success:function(){
                    var focusPicture=$('.focus-picture').val();
                    $('.uploadFocusLayer img').attr('src',focusPicture);
                    
                },
                yes:function(index){
                    var layerFocusSrc=$('.uploadFocusLayer img').attr('src');
                    $('.focus-picture').val(layerFocusSrc);
                    layer.close(index);
                }
            })
        });
       
        //编辑商品参数
        var editGoodsParameter=$('#editGoodsParameter').html();
        $('body').on('click','.editGoodsParameter',function(){
            layer.open({
                title:['编辑商品参数','border-bottom:1px solid #d9d9d9;'],
                className:'editParameterLayer',
                content:editGoodsParameter,
                btn:['确定','取消'],
                success:function(){
                    var goodsParameter=$('.goods-parameter').val();
                    $('.editParameterLayer .editGoodsText').val(goodsParameter);
                },
                yes:function(index){
                    var editGoodsText=$('.editParameterLayer .editGoodsText').val();
                    $('.goods-parameter').val(editGoodsText);
                    layer.close(index);
                }
            })
        })
        //编辑商品详情
        var editDetail=$('#editDetail').html();
        $('body').on('click','.editDetail',function(){
            layer.open({
                // title:['商品分类标签','border-bottom:1px solid #d9d9d9'],
                className:'editDetailLayer',
                content:editDetail,
                btn:['确定','取消'],
                success:function(){
                    var html='';
                    html+='<li>';
                    html+='<div class="picture-module active">';
                    html+='<input type="file" class="uploadImg" name="">';
                    html+='<span class="delete-picture">X</span>';
                    html+='<img src="" class="upload_img">';
                    html+='</div>'
                    html+='</li>';
                    var multiImgAttr=$('.goods-detail').data('src');
                    console.log(multiImgAttr.length);
                    for(var i=0;i<multiImgAttr.length;i++){
                        $('.editDetailLayer .multi-picture-module').append(html);
                        $('.editDetailLayer .upload_img').eq(i).attr('src',multiImgAttr[i]);
                    }
                },
                yes:function(index){
                    var layermultiImgAttr=[];
                    $.each($('.editDetailLayer li'),function(i,val){
                        var _this=$(this);
                        var imgSrc=_this.find('img').attr('src');
                        layermultiImgAttr.push(imgSrc);
                    })
                    $('.goods-detail').data('src',layermultiImgAttr);
                    layer.close(index);
                }
            })
        });
        //设置品类
        var categoryContent=$('#categoryContent').html();
        $('body').on('click','.set-category',function(){
            layer.open({
                title:['设置商品的检索品类','border-bottom:1px solid #d9d9d9'],
                className:'categoryContentLayer',
                content:categoryContent,
                btn:['确定','取消'],
                success:function(){

                },
                yes:function(index){
                    layer.close(index);
                }
            })
        })
        //增加商品
        $('body').on('click','.identifyNewGoods',function(){
            var goodsDetail=$('.goods-detail').data('src');
            var postData={};
            var postData=$('.addProductContent').serializeObject();
            postData.goodsDetail=goodsDetail;
            
            var content='';
                if(!postData.goodsName){
                    content='请填写商品名称';
                }else if(!postData.goodsCharacter){
                    content='请填写商品特点';
                }else if(!isNumber(postData.settlePrice)){
                    content='请填写结算价';
                }else if(!isNumber(postData.retailPrice)){
                    content='请填写零售价';
                }else if(!postData.thumbnailPicture){
                    content='请上传缩略图';
                }else if(!postData.goodsTag){
                    content='请选择标签';
                }else if(!postData.focusPicture){
                    content='请上传首焦图';
                }else if(!postData.goodsParameter){
                    content='请填写商品参数';
                }else if(!goodsDetail){
                    content='请上传商品详情图';
                }
                if(content){
                    dialog.error(content);
                }else{
                    $.post('',postData,function(){
                    })
                }
            
        })

    })
</script>
</body>

</html>